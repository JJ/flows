---
title: "Dominant Flows Analysis"
author: "Timothee Giraud"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Dominant_Flows_Analysis}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

## The method
Dominant Flows Analysis establishes a hierarchy between nodes.
Used in geography it shows the influence of the distance and barrier effects on 
regionalisation.  

## Data
Data used here are residential migrations between *communes* of the Lot *d√©partement* from 2003 to 2008. 

## How to use the package
First case :   
`i` is dominated by `j` when:  

* `i` sends its biggest flow to `j`  
* `j` receives more flows than `i`


The flowDom function computes the dominant flows.

```{r, fig.show='hold', fig.width = 6, fig.height=6, results='hide'}
library(flow)

data(LoireAtlantique)

dom1<- flowDom(mat = MRE44,
               i = "DCRAN",
               j = "CODGEO",
               fij = "NBFLUX_C08_POP05P")
```

The output of the fowDom function is a set of i j couples where i is dominated by j. 

```{r, fig.show='hold', fig.width = 7, fig.height=7}
head(dom1)
```

The next function plots the dominant flows on a map.

```{r, fig.show='hold', fig.width = 6, fig.height=6}
plotflowDom(fdom = dom1, spdf = COM44, id = "INSEE_COM")
title("Residential Dominant Flows")
```

Second case :   
`i` is dominated by `j` when:    

* `i` sends at least a share of its flows to `j`   
* `j` receives more flows than `i`

Here, the k parameter sets the share of i outputed flows toward j.

```{r, fig.show='hold', fig.width = 6, fig.height=6, results = 'hide'}
dom2 <- flowDom(mat = MRE44,
                i = "DCRAN",
                j = "CODGEO",
                fij = "NBFLUX_C08_POP05P", 
                k = 0.2)
```


Then we plot the Map.
```{r, fig.show='hold', fig.width = 6, fig.height=6}
plotflowDom(fdom = dom2, spdf = COM44, id = "INSEE_COM")
title("Residential Dominant Flows (20% flows threshold)")
```

It is also possible to add the names of dominant centers interactively by using the
name parameter. Each click on a unit will display its name on the map. This function can only be used in an interactive environnement.





